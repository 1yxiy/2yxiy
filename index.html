<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>폴더폰 문자 제너레이터</title>
<link href="https://fonts.googleapis.com/css2?family=DotGothic16&family=Noto+Sans+KR:wght@900&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  background: #111;
  min-height: 100vh;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding: 40px 20px;
  font-family: 'Noto Sans KR', sans-serif;
}

.layout {
  display: flex;
  gap: 52px;
  align-items: flex-start;
  flex-wrap: wrap;
  justify-content: center;
  width: 100%;
  max-width: 1020px;
}

.phone-shell {
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}
.shell-lbl { font-size: 9px; color: #2a2a2a; letter-spacing: 4px; }

#phone-screen {
  width: 360px;
  height: 480px;
  position: relative;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  background: #eef2f4;
  border: 2px solid #999;
}

#phone-screen::before {
  content: '';
  position: absolute;
  inset: 0;
  background: repeating-linear-gradient(
    0deg,
    rgba(0,0,0,0.07) 0px, rgba(0,0,0,0.07) 1px,
    transparent 1px, transparent 3px
  );
  pointer-events: none;
  z-index: 900;
}
#phone-screen::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(150deg,
    rgba(255,255,255,0.12) 0%, transparent 40%,
    rgba(0,0,30,0.04) 100%
  );
  pointer-events: none;
  z-index: 901;
}

/* ── 상태바 ── */
.ph-status {
  flex-shrink: 0;
  height: 26px;
  background: #e4ecf0;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 7px;
  border-bottom: 1px solid #c0ccd4;
}

/* ── 타이틀바 ── */
.ph-titlebar {
  flex-shrink: 0;
  height: 40px;
  background: linear-gradient(180deg, #c0dff5 0%, #8ec0e8 50%, #78acd8 100%);
  border-bottom: 2px solid #5890c0;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.4);
}
.ph-titlebar-txt {
  font-family: 'Noto Sans KR', sans-serif;
  font-weight: 900;
  font-size: 21px;
  color: #0a0a18;
  letter-spacing: 3px;
  -webkit-font-smoothing: none;
  text-rendering: optimizeSpeed;
}

/* ── 본문 ── */
.ph-body {
  flex: 1;
  background: #eef2f4;
  padding: 10px 10px 6px 10px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  overflow: hidden;
  position: relative;
}

/* ── 발신자 행 ── */
.ph-sender-row {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-shrink: 0;
}
.ph-sender-name {
  font-family: 'DotGothic16', monospace;
  font-size: 17px;
  color: #0a0a18;
  -webkit-font-smoothing: none;
}
.ph-sender-line {
  flex: 1;
  height: 2px;
  background: #4a7898;
}

/* ── 파란 메시지 박스 ── */
.ph-msgbox {
  flex: 1;
  background: #8fc8dc;
  border: 2px solid #4a7898;
  border-left: 3px solid #2a5878;
  border-top: 3px solid #2a5878;
  padding: 8px 10px;
  overflow: hidden;
  position: relative;
}
.ph-msg-txt {
  font-family: 'DotGothic16', monospace;
  font-size: 28px;
  line-height: 1.35;
  color: #060810;
  word-break: break-all;
  white-space: pre-wrap;
  -webkit-font-smoothing: none;
  text-shadow:
    0 0 1px rgba(0,0,60,0.4),
    1px 0 0 rgba(0,0,30,0.12);
}

/* byte — 우측 하단 */
.ph-byte {
  position: absolute;
  bottom: 6px;
  right: 8px;
  font-family: 'DotGothic16', monospace;
  font-size: 13px;
  color: #336688;
  -webkit-font-smoothing: none;
}

/* ── 하단 버튼 ── */
.ph-btns {
  flex-shrink: 0;
  height: 46px;
  display: flex;
  background: linear-gradient(180deg, #b8c8d4 0%, #c8d8e0 100%);
  border-top: 2px solid #6688aa;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.5);
}
.ph-btn {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  border-right: 1px solid #5577aa;
  position: relative;
}
.ph-btn::after {
  content: '';
  position: absolute;
  right: 0; top: 5px; bottom: 5px;
  width: 1px;
  background: rgba(255,255,255,0.35);
}
.ph-btn:last-child { border-right: none; }
.ph-btn:last-child::after { display: none; }
.ph-btn-lbl {
  font-family: 'Noto Sans KR', sans-serif;
  font-weight: 900;
  font-size: 18px;
  color: #0a0a18;
  -webkit-font-smoothing: none;
  text-rendering: optimizeSpeed;
  text-shadow: 0 1px 0 rgba(255,255,255,0.4);
}

/* =============================================
   CONTROLS
============================================= */
.panel {
  flex: 1;
  min-width: 250px;
  max-width: 300px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.panel-hd { font-size: 9px; color: #333; letter-spacing: 5px; padding-bottom: 8px; border-bottom: 1px solid #1e1e1e; }

.block { background: #181818; border: 1px solid #252525; padding: 14px; display: flex; flex-direction: column; gap: 10px; }
.block-hd { font-size: 9px; color: #3a3a3a; letter-spacing: 3px; padding-bottom: 6px; border-bottom: 1px solid #222; }

label { display: block; font-size: 10px; color: #444; margin-bottom: 4px; letter-spacing: 1px; }

textarea, input[type="text"] {
  width: 100%; background: #0c0c0c; border: 1px solid #2a2a2a;
  color: #ccc; font-family: 'Noto Sans KR', sans-serif; font-size: 14px;
  padding: 8px 10px; outline: none; border-radius: 0;
}
textarea { resize: vertical; min-height: 90px; line-height: 1.6; }
textarea:focus, input[type="text"]:focus { border-color: #444; }
input[type="range"] { width: 100%; accent-color: #446688; }

.sz-row { display: flex; align-items: center; gap: 10px; }
.sz-val { font-size: 12px; color: #446688; min-width: 36px; }
.row { display: flex; gap: 8px; }
.row > div { flex: 1; }

.btn-save {
  width: 100%; background: #0e1820; border: 1px solid #243448;
  color: #5a8aaa; font-family: 'Noto Sans KR', sans-serif;
  font-size: 14px; font-weight: 700; padding: 13px; cursor: pointer;
  text-align: center; letter-spacing: 1px; border-radius: 0; transition: background .12s;
}
.btn-save:hover { background: #142030; color: #7aaacc; }
.note { font-size: 10px; color: #2a2a2a; text-align: center; line-height: 1.9; }
</style>
</head>
<body>

<div class="layout">

  <div class="phone-shell">
    <div class="shell-lbl">PREVIEW</div>

    <div id="phone-screen">

      <div class="ph-status">
        <svg width="44" height="20" viewBox="0 0 44 20" fill="none">
          <line x1="2" y1="18" x2="6" y2="2" stroke="#223" stroke-width="2" stroke-linecap="square"/>
          <rect x="10" y="13" width="5" height="6"  fill="#223"/>
          <rect x="17" y="9"  width="5" height="10" fill="#223"/>
          <rect x="24" y="5"  width="5" height="14" fill="#223"/>
          <rect x="31" y="1"  width="5" height="18" fill="#223"/>
        </svg>
        <svg width="35" height="18" viewBox="0 0 35 18" fill="none">
          <rect x="1" y="2" width="29" height="14" rx="2" stroke="#223" stroke-width="2"/>
          <rect x="30" y="6" width="4" height="6" rx="1" fill="#223"/>
          <rect x="4"  y="5" width="5" height="8" fill="#223"/>
          <rect x="11" y="5" width="5" height="8" fill="#223"/>
          <rect x="18" y="5" width="5" height="8" fill="#223"/>
        </svg>
      </div>

      <div class="ph-titlebar">
        <div class="ph-titlebar-txt">메시지 작성</div>
      </div>

      <div class="ph-body">

        <div class="ph-sender-row">
          <svg width="22" height="18" viewBox="0 0 22 18" fill="none">
            <rect x="0" y="0" width="22" height="18" rx="1" fill="#d8e8f4" stroke="#223" stroke-width="1.5"/>
            <polyline points="0,0 11,10 22,0" stroke="#223" stroke-width="1.5" fill="none"/>
          </svg>
          <div class="ph-sender-name" id="ph-sender-name">발신자</div>
          <div class="ph-sender-line"></div>
        </div>

        <div class="ph-msgbox">
          <div class="ph-msg-txt" id="ph-msg-txt">내용을 입력하세요</div>
          <div class="ph-byte" id="ph-byte">0 / 80 byte</div>
        </div>

      </div>

      <div class="ph-btns">
        <div class="ph-btn"><div class="ph-btn-lbl">메뉴</div></div>
        <div class="ph-btn"><div class="ph-btn-lbl">OK</div></div>
        <div class="ph-btn"><div class="ph-btn-lbl" id="ph-btn3">제작자</div></div>
      </div>

    </div>

    <div class="shell-lbl">360 × 480</div>
  </div>

  <div class="panel">
    <div class="panel-hd">FOLDER PHONE GENERATORS</div>

    <div class="block">
      <div class="block-hd">내용 설정</div>
      <div>
        <label>발신자 이름</label>
        <input type="text" id="c-sender" value="발신자" oninput="syncSender()">
      </div>
      <div>
        <label>메시지 내용 (줄바꿈 가능)</label>
        <textarea id="c-content" placeholder="내용을 입력하세요..." oninput="syncContent()"></textarea>
      </div>
      <div>
        <label>텍스트 크기</label>
        <div class="sz-row">
          <input type="range" id="c-size" min="16" max="48" value="28" oninput="syncSize()">
          <span class="sz-val" id="sz-disp">28px</span>
        </div>
      </div>
    </div>

    <div class="block">
      <div class="block-hd">byte 카운터</div>
      <div class="row">
        <div>
          <label>최대 byte</label>
          <input type="text" id="c-maxbyte" value="80" oninput="syncContent()">
        </div>
        <div>
          <label>현재</label>
          <input type="text" id="c-byteshow" readonly style="color:#446688;background:#080808">
        </div>
      </div>
    </div>

    <div class="block">
      <div class="block-hd">하단 버튼</div>
      <div>
        <label>오른쪽 버튼 (제작자/한글/기타)</label>
        <input type="text" id="c-btn3" value="제작자" oninput="syncBtn3()" placeholder="제작자">
      </div>
    </div>

    <div class="block">
      <div class="block-hd">저장 옵션</div>
      <div>
        <label>기울기 각도</label>
        <div class="sz-row">
          <input type="range" id="c-angle" min="-25" max="25" value="-12" oninput="updateLabels()">
          <span class="sz-val" id="angle-disp">-12°</span>
        </div>
      </div>
      <div>
        <label>배경 밝기</label>
        <div class="sz-row">
          <input type="range" id="c-bgbright" min="0" max="50" value="6" oninput="updateLabels()">
          <span class="sz-val" id="bg-disp">6</span>
        </div>
      </div>
      <button class="btn-save" onclick="saveWithBg()">저장</button>
    </div>

  </div>
</div>

<script>
function syncSender() {
  document.getElementById('ph-sender-name').textContent = document.getElementById('c-sender').value || '발신자';
}
function syncContent() {
  const txt = document.getElementById('c-content').value;
  document.getElementById('ph-msg-txt').textContent = txt || '';
  let bytes = 0;
  for (const ch of txt) bytes += ch.charCodeAt(0) > 127 ? 2 : 1;
  const max = parseInt(document.getElementById('c-maxbyte').value) || 80;
  const str = `${bytes} / ${max} byte`;
  document.getElementById('ph-byte').textContent = str;
  document.getElementById('c-byteshow').value = str;
}
function syncSize() {
  const sz = document.getElementById('c-size').value;
  document.getElementById('sz-disp').textContent = sz + 'px';
  document.getElementById('ph-msg-txt').style.fontSize = sz + 'px';
}
function syncBtn3() {
  document.getElementById('ph-btn3').textContent = document.getElementById('c-btn3').value || '제작자';
}
function updateLabels() {
  document.getElementById('angle-disp').textContent = document.getElementById('c-angle').value + '°';
  document.getElementById('bg-disp').textContent    = document.getElementById('c-bgbright').value;
}

function pixelate(src) {
  const BLOCK = 2;
  const W = src.width, H = src.height;
  const small = document.createElement('canvas');
  small.width  = Math.max(1, Math.floor(W / BLOCK));
  small.height = Math.max(1, Math.floor(H / BLOCK));
  const sCtx = small.getContext('2d');
  sCtx.imageSmoothingEnabled = false;
  sCtx.drawImage(src, 0, 0, small.width, small.height);
  const big = document.createElement('canvas');
  big.width = W; big.height = H;
  const bCtx = big.getContext('2d');
  bCtx.imageSmoothingEnabled = false;
  bCtx.drawImage(small, 0, 0, W, H);
  return big;
}

function saveWithBg() {
  const angle  = parseInt(document.getElementById('c-angle').value);
  const bright = parseInt(document.getElementById('c-bgbright').value);

  html2canvas(document.getElementById('phone-screen'), {
    scale: 2,
    backgroundColor: '#eef2f4',
    useCORS: true,
    logging: false,
    allowTaint: true,
  }).then(captured => {

    const pixelated = pixelate(captured);

    const ctx2 = pixelated.getContext('2d');
    const imgData = ctx2.getImageData(0, 0, pixelated.width, pixelated.height);
    const d = imgData.data;
    for (let i = 0; i < d.length; i += 4) {
      const n = (Math.random() - 0.5) * 18;
      d[i]   = Math.min(255, Math.max(0, d[i]   + n - 2));
      d[i+1] = Math.min(255, Math.max(0, d[i+1] + n));
      d[i+2] = Math.min(255, Math.max(0, d[i+2] + n + 5));
    }
    ctx2.putImageData(imgData, 0, 0);

    const W = 900, H = 1100;
    const out = document.createElement('canvas');
    out.width = W; out.height = H;
    const ctx = out.getContext('2d');

    const bg = ctx.createRadialGradient(W*0.42, H*0.38, 0, W*0.42, H*0.38, W*0.85);
    bg.addColorStop(0,   `rgb(${bright+18},${bright+16},${bright+12})`);
    bg.addColorStop(0.5, `rgb(${bright+6}, ${bright+5}, ${bright+3})`);
    bg.addColorStop(1,   `rgb(${Math.max(0,bright-4)},${Math.max(0,bright-4)},${Math.max(0,bright-4)})`);
    ctx.fillStyle = bg;
    ctx.fillRect(0, 0, W, H);

    const gd = ctx.getImageData(0, 0, W, H);
    const gdArr = gd.data;
    for (let i = 0; i < gdArr.length; i += 4) {
      const g = (Math.random() - 0.5) * 26;
      gdArr[i]   = Math.min(255, Math.max(0, gdArr[i]   + g));
      gdArr[i+1] = Math.min(255, Math.max(0, gdArr[i+1] + g));
      gdArr[i+2] = Math.min(255, Math.max(0, gdArr[i+2] + g));
    }
    ctx.putImageData(gd, 0, 0);

    const sw = pixelated.width, sh = pixelated.height;
    const sc = Math.min(W * 0.70 / sw, H * 0.70 / sh);
    const dw = sw * sc, dh = sh * sc;

    ctx.save();
    ctx.translate(W * 0.50, H * 0.46);
    ctx.rotate(angle * Math.PI / 180);
    ctx.shadowColor   = 'rgba(0,0,0,0.92)';
    ctx.shadowBlur    = 80;
    ctx.shadowOffsetX = 14;
    ctx.shadowOffsetY = 26;
    ctx.imageSmoothingEnabled = false;
    ctx.drawImage(pixelated, -dw/2, -dh/2, dw, dh);
    ctx.restore();

    const vig = ctx.createRadialGradient(W/2, H/2, H*0.28, W/2, H/2, H*0.85);
    vig.addColorStop(0, 'rgba(0,0,0,0)');
    vig.addColorStop(1, 'rgba(0,0,0,0.65)');
    ctx.fillStyle = vig;
    ctx.fillRect(0, 0, W, H);

    const a = document.createElement('a');
    a.download = 'folderphone_' + Date.now() + '.png';
    a.href = out.toDataURL('image/png');
    a.click();
  });
}
</script>
</body>
</html>
